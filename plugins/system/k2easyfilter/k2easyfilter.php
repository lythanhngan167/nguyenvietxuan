<?php// no direct accessdefined('_JEXEC') or die('Restricted access');jimport('joomla.plugin.plugin');jimport('joomla.html.parameter');class plgSystemK2EasyFilter extends JPlugin {		function onAfterRoute() {			$version = new JVersion;			$joomlaVersion = $version->RELEASE;								if (!defined('DS')) define('DS', DIRECTORY_SEPARATOR);			$pluginPath = JPATH_BASE.DS.'plugins'.DS.'system'.DS.'k2easyfilter'.DS.'K2EasyFilter';			$plugin = JPluginHelper::getPlugin('system', 'k2easyfilter');			$plgParams = class_exists('JParameter') ? new JParameter($plugin->params) : new JRegistry($plugin->params);			if(JRequest::getVar("option") == "com_k2" && JRequest::getVar("view") == "itemlist") {							$mainframe = JFactory::getApplication();								$component = JRequest::getVar("option");				$view = JRequest::getVar("view");				$task = JRequest::getVar("task");				$format = JRequest::getVar("format");								if($task == "easyfilter") {					ini_set("display_errors", "On");									error_reporting(E_ALL & ~E_STRICT & ~E_NOTICE & ~E_WARNING & ~E_DEPRECATED);													if (!defined('JPATH_ROOT')) {					   define('JPATH_ROOT', JPath::clean(JPATH_SITE));					}												if (!defined('JPATH_COMPONENT')) define( 'JPATH_COMPONENT',	JPATH_BASE.'/components/com_k2');					if (!defined('JPATH_COMPONENT_SITE')) define( 'JPATH_COMPONENT_SITE', JPATH_SITE.DS.'components'.DS.'com_k2');					if (!defined('JPATH_COMPONENT_ADMINISTRATOR')) define( 'JPATH_COMPONENT_ADMINISTRATOR',	JPATH_ADMINISTRATOR.DS.'components'.DS.'com_k2');										require_once (JPATH_SITE.DS.'components'.DS.'com_k2'.DS.'controllers'.DS.'itemlist.php');					$controller = new K2ControllerItemlist;														$config['name'] =  "itemlist";					$config['default_task'] =  "display";					$config['base_path'] =  $pluginPath;					$config['model_path'] =  $pluginPath.DS."models";					$config['view_path'] =  $pluginPath.DS."views";										$controller->__construct($config);											switch($format) {												case "feed" :							$view = $controller->getView("itemlist", "feed");						break;												case "html" :							$view = $controller->getView("itemlist", "html");						break;																		default :							$view = $controller->getView("itemlist", "html");						break;					}					$controller->addModelPath($pluginPath.DS."models");					$cache = JFactory::getCache("com_k2");					$cache->clean();														}			}	}	}